/* レトロゲーム風のリセットと基本設定 */
* {
  box-sizing: border-box;
  touch-action: manipulation; /* スマホでのダブルタップ拡大防止 */
}

body {
  font-family: 'Courier New', monospace;
  text-align: center;
  background-color: #111;
  color: #eee;
  margin: 0;
  padding: 5px;
  /* ドット絵をくっきり表示 */
  image-rendering: pixelated; 
  image-rendering: -moz-crisp-edges;
  image-rendering: crisp-edges;
}

h1 { margin: 5px 0; font-size: 18px; color: #ffd700; text-shadow: 1px 1px #000; }
h2, h3 { margin: 5px 0; }

.hidden { display: none !important; }

#game-container {
  display: flex;
  flex-direction: column;
  align-items: center;
  width: 100%;
  max-width: 450px; /* 画面幅を制限 */
  margin: 0 auto;
}

#status-bar {
  display: flex;
  justify-content: space-around;
  width: 100%;
  background: #222;
  padding: 4px;
  border: 2px solid #555;
  border-radius: 4px;
  margin-bottom: 5px;
  font-size: 12px;
  font-weight: bold;
}
#gold-display { color: #ffeb3b; }
#mp-display { color: #88f; }

#message-box {
  background-color: #333;
  color: #fff;
  border: 2px solid #eee;
  padding: 4px;
  margin-bottom: 5px;
  width: 100%;
  font-size: 12px;
  min-height: 24px;
}

/* --- 画面エリア設定 --- */
#screen-area {
  position: relative;
  /* 7マス * 60px = 420px。枠線込みで調整 */
  width: 424px; 
  height: 424px;
  border: 4px solid #777;
  background-color: #000;
  overflow: hidden; /* はみ出た部分を隠す */
}

/* --- フィールド設定 (カメラ追従) --- */
#field {
  display: grid;
  /* 7x7 の表示 */
  grid-template-columns: repeat(7, 60px);
  grid-template-rows: repeat(7, 60px);
  gap: 0;
}

.cell {
  width: 60px;
  height: 60px;
  background-size: cover;
  background-position: center;
  border: 1px solid rgba(255,255,255,0.1); /* 薄いグリッド線 */
  display: flex;
  justify-content: center;
  align-items: center;
  font-size: 24px;
  color: transparent; /* 文字は隠す */
}

/* マップチップ */
.tile-empty { background-color: #7cba3f; } /* 草原 */
.tile-city  { background-color: #c2b280; border: 2px solid #5a3e19; } /* 街 */
.tile-wall  { background-color: #555; } /* マップ外の壁 */
.tile-enemy { background-image: url('./goburin.png'); background-color: #7cba3f; }

/* 主人公（中央に固定表示） */
.player-marker {
  position: absolute;
  top: 180px;  /* (420/2) - (60/2) = 中央 */
  left: 180px;
  width: 60px;
  height: 60px;
  background-image: url('./hero.png'); /* 主人公画像 */
  background-size: cover;
  z-index: 10;
  border: 2px solid yellow; /* 視認性アップ */
}

/* --- 街・戦闘画面 (オーバーレイ) --- */
.overlay-screen {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0,0,0,0.85);
  color: #fff;
  padding: 10px;
  display: flex;
  flex-direction: column;
  align-items: center;
  z-index: 20;
}

#town { background-color: #3e2723; }
#battle { 
  background: linear-gradient(to bottom, #000046, #1cb5e0);
  justify-content: space-between;
}

/* 戦闘画面の要素 */
.hp-box {
  width: 100%;
  text-align: left;
  font-size: 14px;
  text-shadow: 1px 1px 0 #000;
  padding: 5px;
}

.enemy-img {
  width: 160px; /* 敵画像を大きく */
  height: 160px;
  object-fit: contain;
  margin: 10px auto;
}

#battle-log-container {
  width: 100%;
  background: rgba(0,0,0,0.6);
  border: 2px solid #fff;
  padding: 5px;
  min-height: 50px;
  display: flex;
  align-items: center;
  justify-content: center;
}
#battle-log { font-size: 14px; font-weight: bold; }

#command-area {
  width: 100%;
  margin-bottom: 5px;
}

#main-commands, .sub-menu {
  display: flex;
  justify-content: center;
  gap: 5px;
  flex-wrap: wrap;
}

button {
  background: #333;
  color: #fff;
  border: 2px solid #777;
  padding: 8px 12px;
  font-family: inherit;
  font-size: 14px;
  cursor: pointer;
  border-radius: 4px;
}
button:hover { background: #555; border-color: #fff; }
button:active { background: #777; }

.item-btn { width: 80%; margin: 5px auto; display: block; }

/* --- コントローラー --- */
#controller {
  margin-top: 10px;
  padding: 10px;
  background: #222;
  border-radius: 10px;
}
.d-pad {
  display: flex;
  flex-direction: column;
  align-items: center;
}
.d-row { display: flex; gap: 5px; margin: 2px; }
#controller button {
  width: 60px;
  height: 60px;
  font-size: 24px;
  background: #444;
  border-color: #222;
  box-shadow: 2px 2px 0 #000;
}
#controller button:active {
  transform: translate(2px, 2px);
  box-shadow: none;
}